# HALFpipe-cwas

## Background
The reproducibility crisis in neuroimaging has affected many research domains, and psychiatric research is no exception ([Botvinik-Nezer & Wager, 2023](https://doi.org/10.1016/j.bpsc.2022.12.006)). Indeed, psychiatric studies using neuroimaging tools have long struggled with poor reproducibility, largely due to small sample sizes and significant heterogeneity in analysis methods.

To address this issue, initiatives such as the ENIGMA consortium (Enhancing NeuroImaging Genetics through Meta-Analyses) were launched ([Thompson et al., 2014](https://doi.org/10.1007/s11682-013-9269-5)). ENIGMA is a consortium comprising numerous research sites and organized into several Disease Working Groups that focus on most major psychiatric conditions. It promotes a collaborative framework: while data remain at local sites, analyses follow standardized protocols, enabling large-scale meta-analyses across cohorts.

This approach has proven successful for structural and diffusion MRI, thanks to the development of open and reproducible protocols (https://enigma.ini.usc.edu/protocols/). In this context, [Waller et al. (2022)](https://doi.org/10.1002/hbm.25829) developed HALFpipe, an open-source software that facilitates the preprocessing and extraction of connectivity matrices from functional MRI data. However, no standard tools has yet been proposed by ENIGMA for statistical analyses of functional connectivity matrices.

## Objectives
### Main objective
This project aims to support the broader collaborative effort by developing a dedicated library for conducting Connectome-Wide Association Studies (CWAS) based on connectivity matrices generated by HALFpipe.

In the long term, this library could be integrated into existing tools such as HALFpipe or the ENIGMA Toolbox, ensuring sustainability and continued maintenance.

### Objectives for BrainHack school
1. Learn how to write scripts in python following the BIDS-app workflow ([Gorgolewski et al., 2017](https://doi.org/10.1371/journal.pcbi.1005209))
2. Learn how to build a project with automated tests on GitHub
3. Learn how to develop a sustainable and easy-to-use python library
 
## Tools
This project uses the following tools and standards to ensure reproducibility, openness, and long-term usability:
- HALFpipe: Provides a reproducible preprocessing pipeline for fMRI data.
- Datalad : To download datasets with specific versions or subsets of a dataset
- Git & GitHub: 
   - Enables version control and promotes open-source, collaborative development of the library.
   - Implements automated testing and continuous integration to maintain code quality during development.
- BIDS Ecosystem: Ensures compatibility with the BIDS standard, following the workflow of a BIDS App ([Gorgolewski et al., 2017](https://doi.org/10.1371/journal.pcbi.1005209)).
- Python Packaging: Distributes the tool as an installable open-source Python library for easy integration and reuse.

## Data
3 Open source datasets with accesible phenotype files to test the pipeline : 
- [UCLA Consortium for Neuropsychiatric Phenomics LA5c Study (ds000030)](https://openneuro.org/datasets/ds000030/versions/00016)
- [Resting State MRI data from healthy control (HC), Parkinson's disease with normal cognition (PD-NC), and Parkinson's disease with mild cognitive impairment (PD-MCI) cohorts (ds005892)](https://openneuro.org/datasets/ds005892/versions/1.0.0)
- [MRI data of 3-12 year old children and adults during viewing of a short animated film (ds000228)](https://openneuro.org/datasets/ds000228/versions/1.1.0)
   
## Deliverables
- A GitHub action repository that automatically test new request from users
- A Jupyter Notebook for a tutorial and example
- A GitHub page with documentation on how to use the pipeline

## References
Botvinik-Nezer, R., & Wager, T. D. (2023). Reproducibility in Neuroimaging Analysis: Challenges and Solutions. Biological psychiatry. Cognitive neuroscience and neuroimaging, 8(8), 780–788. https://doi.org/10.1016/j.bpsc.2022.12.006

Gorgolewski, K. J., Alfaro-Almagro, F., Auer, T., Bellec, P., Capotă, M., Chakravarty, M. M., Churchill, N. W., Cohen, A. L., Craddock, R. C., Devenyi, G. A., Eklund, A., Esteban, O., Flandin, G., Ghosh, S. S., Guntupalli, J. S., Jenkinson, M., Keshavan, A., Kiar, G., Liem, F., Raamana, P. R., … Poldrack, R. A. (2017). BIDS apps: Improving ease of use, accessibility, and reproducibility of neuroimaging data analysis methods. PLoS computational biology, 13(3), e1005209. https://doi.org/10.1371/journal.pcbi.1005209

Thompson, P. M., Stein, J. L., Medland, S. E., Hibar, D. P., Vasquez, A. A., Renteria, M. E., Toro, R., Jahanshad, N., Schumann, G., Franke, B., Wright, M. J., Martin, N. G., Agartz, I., Alda, M., Alhusaini, S., Almasy, L., Almeida, J., Alpert, K., Andreasen, N. C., Andreassen, O. A., … Alzheimer’s Disease Neuroimaging Initiative, EPIGEN Consortium, IMAGEN Consortium, Saguenay Youth Study (SYS) Group (2014). The ENIGMA Consortium: large-scale collaborative analyses of neuroimaging and genetic data. Brain imaging and behavior, 8(2), 153–182. https://doi.org/10.1007/s11682-013-9269-5

Waller, L., Erk, S., Pozzi, E., Toenders, Y. J., Haswell, C. C., Büttner, M., Thompson, P. M., Schmaal, L., Morey, R. A., Walter, H., & Veer, I. M. (2022). ENIGMA HALFpipe: Interactive, reproducible, and efficient analysis for resting-state and task-based fMRI data. Human brain mapping, 43(9), 2727–2742. https://doi.org/10.1002/hbm.25829
